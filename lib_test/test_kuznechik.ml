(* Testing *)

let key_test: bytes = Bytes.of_seq (List.to_seq [
  0x88; 0x99; 0xaa; 0xbb;
  0xcc; 0xdd; 0xee; 0xff;
  0x00; 0x11; 0x22; 0x33;
  0x44; 0x55; 0x66; 0x77;
  0xfe; 0xdc; 0xba; 0x98;
  0x76; 0x54; 0x32; 0x10;
  0x01; 0x23; 0x45; 0x67;
  0x89; 0xab; 0xcd; 0xef;
] |> Seq.map (fun x -> Char.chr x))

let block_test: bytes = Bytes.of_seq (List.to_seq [
  0x11; 0x22; 0x33; 0x44;
  0x55; 0x66; 0x77; 0x00;
  0xff; 0xee; 0xdd; 0xcc;
  0xbb; 0xaa; 0x99; 0x88;
] |> Seq.map (fun x -> Char.chr x))

let () =
  Printf.printf "%s\n" ((Kuznechik.encrypt_block key_test block_test) |> Hex.of_bytes |> Hex.show);;
  Printf.printf "%s\n" ((Kuznechik.encrypt_block key_test block_test) |> (Kuznechik.decrypt_block key_test) |> Hex.of_bytes |> Hex.show);;
